apply plugin: 'com.android.application'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-kapt'
apply plugin: 'realm-android'

def config = rootProject.extensions.getByName("ext")

android {
    compileSdkVersion config.getAt("compileSdkVersion")
    buildToolsVersion config.getAt("buildToolsVersion")

    defaultConfig {
        minSdkVersion config.getAt("minSdkVersion")
        targetSdkVersion config.getAt("targetSdkVersion")
        versionCode config.getAt("versionCode")
        versionName config.getAt("versionName")
        applicationId config.getAt("applicationId") + "app"
        multiDexEnabled true
    }

    lintOptions {
        abortOnError false
    }

    sourceSets {
        main.java.srcDirs += 'src/main/kotlin'
    }

    packagingOptions {
        exclude 'META-INF/rxjava.properties'
    }

    dataBinding {
        enabled = true
    }
}

dependencies {
    def dependencies = config.appDependencies

    compile config.kotlin
    compile dependencies.kotlinReflect

    compile dependencies.glide

    kapt dependencies.databinding

    kapt dependencies.daggerCompiler
    compile dependencies.dagger
    provided dependencies.javax

    compile dependencies.conductor

    compile dependencies.design
    compile dependencies.appCompat

    compile dependencies.rxJava
    compile dependencies.rxAndroid
    compile dependencies.rxJavaInterop

    compile dependencies.retrofit
    compile dependencies.retrofitGson
    compile dependencies.retrofitRx
    compile dependencies.okHttp
    compile dependencies.loggingInterceptor

    compile dependencies.fieldNamesHelper

    testCompile testDependencies.junit
    testCompile testDependencies.assertj
    testCompile testDependencies.mockito
    testCompile testDependencies.robolectric
}

task start(type: Exec, dependsOn: 'installDebug') {
    def adb = "$System.env.ANDROID_HOME/platform-tools/adb"

    commandLine 'adb', 'shell', 'am', 'start', '-n', 'mb.pokequiz/.ui.MainActivity'
}

repositories {
    mavenCentral()
}
